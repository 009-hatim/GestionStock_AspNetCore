@model IEnumerable<Gestion.Models.User>

@{
    ViewData["Title"] = "Employés";
}

<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewData["Title"] - Gestion</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --primary: #3b82f6;
            --primary-dark: #2563eb;
            --secondary: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --info: #0ea5e9;
            --dark: #1e293b;
            --light: #f8fafc;
        }

        .table-container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            overflow: hidden;
        }

        .table-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .table-row-hover:hover {
            background-color: #f8fafc;
            transition: all 0.2s ease;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-weight: 500;
            transition: all 0.2s ease;
            text-decoration: none;
            border: none;
            cursor: pointer;
            font-size: 0.875rem;
        }

        .btn-sm {
            padding: 0.375rem 0.75rem;
            font-size: 0.75rem;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

            .btn-primary:hover {
                background-color: var(--primary-dark);
                transform: translateY(-1px);
                box-shadow: 0 4px 12px rgba(37, 99, 235, 0.2);
            }

        .btn-success {
            background-color: var(--secondary);
            color: white;
        }

            .btn-success:hover {
                background-color: #0da271;
                transform: translateY(-1px);
                box-shadow: 0 4px 12px rgba(16, 185, 129, 0.2);
            }

        .btn-warning {
            background-color: var(--warning);
            color: white;
        }

            .btn-warning:hover {
                background-color: #d97706;
                transform: translateY(-1px);
                box-shadow: 0 4px 12px rgba(245, 158, 11, 0.2);
            }

        .btn-danger {
            background-color: var(--danger);
            color: white;
        }

            .btn-danger:hover {
                background-color: #dc2626;
                transform: translateY(-1px);
                box-shadow: 0 4px 12px rgba(239, 68, 68, 0.2);
            }

        .btn-info {
            background-color: var(--info);
            color: white;
        }

            .btn-info:hover {
                background-color: #0284c7;
                transform: translateY(-1px);
                box-shadow: 0 4px 12px rgba(14, 165, 233, 0.2);
            }

        .action-buttons {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.875rem;
        }

        .search-container {
            position: relative;
            width: 100%;
            max-width: 400px;
        }

        .search-input {
            width: 100%;
            padding: 0.75rem 1rem 0.75rem 3rem;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 0.875rem;
            transition: all 0.2s ease;
        }

            .search-input:focus {
                outline: none;
                border-color: var(--primary);
                box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
            }

        .search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: #94a3b8;
        }

        .filters {
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-select {
            padding: 0.5rem 1rem;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            background-color: white;
            font-size: 0.875rem;
            color: #475569;
            transition: all 0.2s ease;
        }

            .filter-select:focus {
                outline: none;
                border-color: var(--primary);
            }

        /* Correction de la media query */
        @@media (max-width: 768px) {
            .table-container {
                overflow-x: auto;
            }

            .action-buttons {
                flex-direction: column;
                min-width: 120px;
            }

            .filters {
                flex-direction: column;
                align-items: stretch;
            }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- En-tête de page -->
        <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-8">
            <div class="mb-6 md:mb-0">
                <h1 class="text-3xl font-bold text-gray-900 mb-2">Gestion des Employés</h1>
                <p class="text-gray-600">
                    @Model.Count() employé@(Model.Count() > 1 ? "s" : "") trouvé@(Model.Count() > 1 ? "s" : "")
                </p>
            </div>

            <div class="flex flex-col sm:flex-row gap-4">
                <!-- Barre de recherche -->
                <div class="search-container">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text"
                           placeholder="Rechercher un employé..."
                           class="search-input"
                           id="searchInput">
                </div>

                <!-- Bouton Ajouter -->
                <a asp-action="Create" class="btn btn-success inline-flex items-center justify-center">
                    <i class="fas fa-user-plus mr-2"></i>
                    Ajouter un Employé
                </a>
            </div>
        </div>

        <!-- Filtres -->
        <div class="filters mb-6 p-4 bg-white rounded-xl shadow-sm">
            <span class="text-gray-700 font-medium">Filtres :</span>
            <select class="filter-select">
                <option value="">Tous les employés</option>
                <option value="recent">Récents</option>
                <option value="ancien">Anciens</option>
            </select>
            <select class="filter-select">
                <option value="">Trier par</option>
                <option value="name">Nom d'utilisateur</option>
                <option value="date">Date de création</option>
                <option value="email">Email</option>
            </select>
            <button class="btn btn-primary">
                <i class="fas fa-filter mr-2"></i>
                Appliquer
            </button>
        </div>

        <!-- Tableau des employés -->
        <div class="table-container">
            <table class="w-full">
                <thead class="table-header">
                    <tr>
                        <th class="py-4 px-6 text-left font-semibold uppercase tracking-wider">
                            <div class="flex items-center">
                                <i class="fas fa-user mr-2"></i>
                                Nom d'utilisateur
                            </div>
                        </th>
                        <th class="py-4 px-6 text-left font-semibold uppercase tracking-wider">
                            <div class="flex items-center">
                                <i class="fas fa-envelope mr-2"></i>
                                Email
                            </div>
                        </th>
                        <th class="py-4 px-6 text-left font-semibold uppercase tracking-wider">
                            <div class="flex items-center">
                                <i class="fas fa-calendar-alt mr-2"></i>
                                Date Création
                            </div>
                        </th>
                        <th class="py-4 px-6 text-left font-semibold uppercase tracking-wider">
                            <div class="flex items-center">
                                <i class="fas fa-cogs mr-2"></i>
                                Actions
                            </div>
                        </th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-gray-200">
                    @{
                        int index = 0;
                        foreach (var e in Model)
                        {
                            index++;
                            <tr class="table-row-hover @(index % 2 == 0 ? "bg-gray-50" : "bg-white")">
                                <td class="py-4 px-6">
                                    <div class="flex items-center">
                                        <div class="avatar mr-3">
                                            @if (!string.IsNullOrEmpty(e.Username) && e.Username.Length > 0)
                                            {
                                                @e.Username.Substring(0, 1).ToUpper()
                                            }
                                            else
                                            {
                                                <text>?</text>
                                            }
                                        </div>
                                        <div class="font-medium text-gray-900">@e.Username</div>
                                    </div>
                                </td>
                                <td class="py-4 px-6">
                                    <div class="text-gray-900">@e.Email</div>
                                </td>
                                <td class="py-4 px-6">
                                    <div class="text-gray-900">@e.CreatedAt.ToString("yyyy-MM-dd")</div>
                                    <div class="text-sm text-gray-500">
                                        <i class="far fa-clock mr-1"></i>
                                        @{
                                            var daysDiff = (DateTime.Now - e.CreatedAt).Days;
                                            if (daysDiff == 0)
                                            {
                                                <text>Aujourd'hui</text>
                                            }
                                            else if (daysDiff == 1)
                                            {
                                                <text>Hier</text>
                                            }
                                            else
                                            {
                                                <text>Il y a @daysDiff jours</text>
                                            }
                                        }
                                    </div>
                                </td>
                                <td class="py-4 px-6">
                                    <div class="action-buttons">
                                        <a asp-action="Details" asp-route-id="@e.Id"
                                           class="btn btn-info btn-sm">
                                            <i class="fas fa-eye mr-1"></i>
                                            Détails
                                        </a>
                                        <a asp-action="Edit" asp-route-id="@e.Id"
                                           class="btn btn-warning btn-sm">
                                            <i class="fas fa-edit mr-1"></i>
                                            Modifier
                                        </a>
                                        <a asp-action="Delete" asp-route-id="@e.Id"
                                           class="btn btn-danger btn-sm">
                                            <i class="fas fa-trash mr-1"></i>
                                            Supprimer
                                        </a>
                                    </div>
                                </td>
                            </tr>
                        }
                    }
                </tbody>
            </table>
        </div>

        <!-- Pagination et statistiques -->
        <div class="flex flex-col md:flex-row justify-between items-center mt-8 p-4 bg-white rounded-xl shadow-sm">
            <div class="text-gray-600 mb-4 md:mb-0">
                <span class="font-medium">@Model.Count()</span> employé@(Model.Count() > 1 ? "s" : "") affiché@(Model.Count() > 1 ? "s" : "")
            </div>

            <div class="flex items-center space-x-2">
                <button class="p-2 rounded-lg hover:bg-gray-100 disabled:opacity-50" disabled>
                    <i class="fas fa-chevron-left"></i>
                </button>
                <span class="px-3 py-1 bg-blue-600 text-white rounded-lg font-medium">1</span>
                <button class="p-2 rounded-lg hover:bg-gray-100">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>

            <div class="mt-4 md:mt-0">
                <select class="filter-select">
                    <option value="10">10 par page</option>
                    <option value="25">25 par page</option>
                    <option value="50">50 par page</option>
                </select>
            </div>
        </div>

        <!-- Aucun résultat -->
        @if (!Model.Any())
        {
            <div class="text-center py-12 bg-white rounded-xl shadow-sm mt-6">
                <i class="fas fa-users text-gray-300 text-5xl mb-4"></i>
                <h3 class="text-xl font-semibold text-gray-700 mb-2">Aucun employé trouvé</h3>
                <p class="text-gray-500 mb-6">Commencez par ajouter votre premier employé.</p>
                <a asp-action="Create" class="btn btn-success">
                    <i class="fas fa-user-plus mr-2"></i>
                    Ajouter un Employé
                </a>
            </div>
        }
    </div>

    <script>
        // Fonctionnalité de recherche
        document.getElementById('searchInput').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const rows = document.querySelectorAll('tbody tr');

            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        });

        // Ajout d'animations sur les boutons
        document.querySelectorAll('.btn').forEach(button => {
            button.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-1px)';
            });

            button.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0)';
            });
        });
    </script>
</body>
</html>